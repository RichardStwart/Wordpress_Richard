!function(r){var a,t,n,i,o,l,d,p,c,u,h,f,v,w=!1;function m(){"function"==typeof zxcvbn?(n.val()?k():(n.val(n.data("pw")),n.trigger("pwupdate")),y(),1!==parseInt(c.data("start-masked"),10)?t.addClass("show-password"):c.trigger("click"),r("#pw-weak-text-label").html(userProfileL10n.warnWeak)):setTimeout(m,50)}function g(){c.data("toggle",0).attr({"aria-label":userProfileL10n.ariaHide}).find(".text").text(userProfileL10n.hide).end().find(".dashicons").removeClass("dashicons-visibility").addClass("dashicons-hidden"),i.focus(),o.attr("for","pass1-text")}function b(){var e,s;a=r(".user-pass1-wrap"),o=a.find("th label").attr("for","pass1-text"),r(".user-pass2-wrap").hide(),h=r("#submit, #wp-submit").on("click",function(){w=!1}),u=h.add(" #createusersub"),d=r(".pw-weak"),(p=d.find(".pw-checkbox")).change(function(){u.prop("disabled",!p.prop("checked"))}),(n=r("#pass1")).length&&(f=n.val(),t=n.parent(),i=r('<input type="text"/>').attr({id:"pass1-text",name:"pass1-text",autocomplete:"off"}).addClass(n[0].className).data("pw",n.data("pw")).val(n.val()).on(v,function(){i.val()!==f&&(l.val(i.val()),n.val(i.val()).trigger("pwupdate"),f=i.val())}),n.after(i),1===parseInt(n.data("reveal"),10)&&m(),n.on(v+" pwupdate",function(){n.val()!==f&&(f=n.val(),i.val()!==f&&i.val(f),n.add(i).removeClass("short bad good strong"),y())})),l=r("#pass2").on(v,function(){0<l.val().length&&(n.val(l.val()),l.val(""),f="",n.trigger("pwupdate"))}),n.is(":hidden")&&(n.prop("disabled",!0),l.prop("disabled",!0),i.prop("disabled",!0)),e=a.find(".wp-pwd"),s=a.find("button.wp-generate-pw"),(c=a.find(".wp-hide-pw")).show().on("click",function(){1===parseInt(c.data("toggle"),10)?(t.addClass("show-password"),g(),_.isUndefined(i[0].setSelectionRange)||i[0].setSelectionRange(0,100)):(t.removeClass("show-password"),c.data("toggle",1).attr({"aria-label":userProfileL10n.ariaShow}).find(".text").text(userProfileL10n.show).end().find(".dashicons").removeClass("dashicons-hidden").addClass("dashicons-visibility"),n.focus(),o.attr("for","pass1"),_.isUndefined(n[0].setSelectionRange)||n[0].setSelectionRange(0,100))}),s.length&&e.hide(),s.show(),s.on("click",function(){w=!0,s.hide(),e.show(),n.attr("disabled",!1),l.attr("disabled",!1),i.attr("disabled",!1),0===i.val().length&&m(),_.defer(function(){i.focus(),_.isUndefined(i[0].setSelectionRange)||i[0].setSelectionRange(0,100)},0)}),a.find("button.wp-cancel-pw").on("click",function(){w=!1,i.val(""),wp.ajax.post("generate-password").done(function(e){n.data("pw",e)}),s.show(),e.hide(),d.hide(0,function(){p.removeProp("checked")}),n.prop("disabled",!0),l.prop("disabled",!0),i.prop("disabled",!0),g(),a.closest("form").is("#your-profile")&&(n.val("").trigger("pwupdate"),u.prop("disabled",!1))}),a.closest("form").on("submit",function(){w=!1,n.prop("disabled",!1),l.prop("disabled",!1),l.val(n.val()),t.removeClass("show-password")})}function k(){var e=r("#pass1").val();if(r("#pass-strength-result").removeClass("short bad good strong"),e)switch(wp.passwordStrength.meter(e,wp.passwordStrength.userInputBlacklist(),e)){case-1:r("#pass-strength-result").addClass("bad").html(pwsL10n.unknown);break;case 2:r("#pass-strength-result").addClass("bad").html(pwsL10n.bad);break;case 3:r("#pass-strength-result").addClass("good").html(pwsL10n.good);break;case 4:r("#pass-strength-result").addClass("strong").html(pwsL10n.strong);break;case 5:r("#pass-strength-result").addClass("short").html(pwsL10n.mismatch);break;default:r("#pass-strength-result").addClass("short").html(pwsL10n.short)}else r("#pass-strength-result").html("&nbsp;")}function y(){var e=r("#pass-strength-result")[0];e.className&&(n.add(i).addClass(e.className),r(e).is(".short, .bad")?(p.prop("checked")||u.prop("disabled",!0),d.show()):(u.prop("disabled",!1),d.hide()))}v="oninput"in document.createElement("input")?"input":"keyup",r(document).ready(function(){var e,a,t,n,i=r("#display_name"),s=i.val(),o=r("#wp-admin-bar-my-account").find(".display-name");r("#pass1").val("").on(v+" pwupdate",k),r("#pass-strength-result").show(),r(".color-palette").click(function(){r(this).siblings('input[name="admin_color"]').prop("checked",!0)}),i.length&&(r("#first_name, #last_name, #nickname").bind("blur.user_profile",function(){var t=[],n={display_nickname:r("#nickname").val()||"",display_username:r("#user_login").val()||"",display_firstname:r("#first_name").val()||"",display_lastname:r("#last_name").val()||""};n.display_firstname&&n.display_lastname&&(n.display_firstlast=n.display_firstname+" "+n.display_lastname,n.display_lastfirst=n.display_lastname+" "+n.display_firstname),r.each(r("option",i),function(e,s){t.push(s.value)}),r.each(n,function(e,s){if(s){var a=s.replace(/<\/?[a-z][^>]*>/gi,"");n[e].length&&-1===r.inArray(a,t)&&(t.push(a),r("<option />",{text:a}).appendTo(i))}})}),i.on("change",function(){if(t===n){var e=r.trim(this.value)||s;o.text(e)}})),e=r("#color-picker"),a=r("#colors-css"),t=r("input#user_id").val(),n=r('input[name="checkuser_id"]').val(),e.on("click.colorpicker",".color-option",function(){var e,s=r(this);if(!s.hasClass("selected")&&(s.siblings(".selected").removeClass("selected"),s.addClass("selected").find('input[type="radio"]').prop("checked",!0),t===n)){if(0===a.length&&(a=r('<link rel="stylesheet" />').appendTo("head")),a.attr("href",s.children(".css_url").val()),"undefined"!=typeof wp&&wp.svgPainter){try{e=r.parseJSON(s.children(".icon_colors").val())}catch(e){}e&&(wp.svgPainter.setColors(e),wp.svgPainter.paint())}r.post(ajaxurl,{action:"save-user-color-scheme",color_scheme:s.children('input[name="admin_color"]').val(),nonce:r("#color-nonce").val()}).done(function(e){e.success&&r("body").removeClass(e.data.previousScheme).addClass(e.data.currentScheme)})}}),b()}),r("#destroy-sessions").on("click",function(e){var s=r(this);wp.ajax.post("destroy-sessions",{nonce:r("#_wpnonce").val(),user_id:r("#user_id").val()}).done(function(e){s.prop("disabled",!0),s.siblings(".notice").remove(),s.before('<div class="notice notice-success inline"><p>'+e.message+"</p></div>")}).fail(function(e){s.siblings(".notice").remove(),s.before('<div class="notice notice-error inline"><p>'+e.message+"</p></div>")}),e.preventDefault()}),window.generatePassword=m,r(window).on("beforeunload",function(){if(!0===w)return userProfileL10n.warn})}(jQuery);